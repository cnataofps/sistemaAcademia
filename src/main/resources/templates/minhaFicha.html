<!DOCTYPE html>
<html lang="pt-br" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head th:replace="~{painel :: header}">
	<style>
		/* Modo Noturno */
		body.dark-mode {
			background-color: #121212;
			color: #e0e0e0;
		}

		body.dark-mode .sidebar {
			background-color: #1f1f1f;
			border-color: #444;
		}

		body.dark-mode .sidebar .nav-link {
			color: #ccc;
		}

		body.dark-mode .sidebar .nav-link:hover {
			background-color: #333;
			color: #0d6efd;
		}

		body.dark-mode .sidebar .nav-link.active {
			background-color: #0d6efd;
			color: white;
		}

		body.dark-mode .content-area,
		body.dark-mode .container {
			background-color: #1e1e1e;
			color: #e0e0e0;
		}

		body.dark-mode .card {
			background-color: #2a2a2a;
			color: #e0e0e0;
		}

		body.dark-mode .form-label {
			color: #e0e0e0;
		}

		body.dark-mode .form-control {
			background-color: #2a2a2a;
			color: #e0e0e0;
			border-color: #555;
		}

		body.dark-mode .form-control::placeholder {
			color: #aaa;
		}

		body.dark-mode .btn {
			color: #e0e0e0;
		}

		body.dark-mode .btn-success {
			background-color: #198754;
			color: #fff;
		}

		body.dark-mode .btn-info {
			background-color: #0dcaf0;
			color: #fff;
		}

		body.dark-mode .btn-warning {
			background-color: #ffc107;
			color: #212529;
		}

		body.dark-mode .btn-danger {
			background-color: #dc3545;
			color: #fff;
		}

		body.dark-mode .text-muted {
			color: #b0b0b0 !important;
		}

		body.dark-mode .text-primary {
			color: #66b2ff !important;
		}

		body.dark-mode i.bi {
			color: #e0e0e0;
		}
	</style>
</head>

<body>
	<div th:replace="~{painel :: navbar}"></div>
	<div class="main-layout">
		<div th:replace="~{painel :: sidebar}"></div>
		<div class="content-area">
			<h2 class="mb-4">üìã Minha Ficha de Treino</h2>

			<!-- ‚úÖ Mensagens de feedback -->
			<div th:if="${sucesso}" class="alert alert-success text-center" role="alert">
				<i class="bi bi-check-circle-fill me-1"></i>
				<span th:text="${sucesso}"></span>
			</div>
			<div th:if="${erro}" class="alert alert-danger text-center" role="alert">
				<i class="bi bi-exclamation-triangle-fill me-1"></i>
				<span th:text="${erro}"></span>
			</div>

			<!-- ‚úÖ Verifica se h√° ficha -->
			<div th:if="${ficha != null}">
				<!-- Card com dados do aluno e da ficha -->
				<div class="card shadow-sm p-4 mb-4">
					<h5 class="mb-3"><i class="bi bi-person-circle me-2"></i>Informa√ß√µes do Aluno</h5>
					<div class="row g-3">
						<div class="col-md-6 col-lg-4">
							<div class="info-box">
								<label class="text-muted">Nome</label>
								<p class="fw-semibold mb-0" th:text="${aluno.nome}"></p>
							</div>
						</div>
						<div class="col-md-6 col-lg-4">
							<div class="info-box">
								<label class="text-muted">Matr√≠cula</label>
								<p class="fw-semibold mb-0" th:text="${aluno.matricula}"></p>
							</div>
						</div>
						<div class="col-md-6 col-lg-4">
							<div class="info-box">
								<label class="text-muted">Objetivo</label>
								<p class="fw-semibold mb-0" th:text="${ficha.objetivo}"></p>
							</div>
						</div>
						<div class="col-md-6 col-lg-4">
							<div class="info-box">
								<label class="text-muted">Data de Cria√ß√£o</label>
								<p class="fw-semibold mb-0"
									th:text="${#temporals.format(ficha.dataCriacao, 'dd/MM/yyyy')}"></p>
							</div>
						</div>
						<div class="col-md-6 col-lg-4">
							<div class="info-box">
								<label class="text-muted">Data de Troca</label>
								<p class="fw-semibold mb-0"
									th:text="${#temporals.format(ficha.dataTroca, 'dd/MM/yyyy')}"></p>
							</div>
						</div>
					</div>
				</div>

				<!-- Card com treinos em abas -->
				<div class="card shadow-sm p-4">
					<h5 class="mb-3">Treinos</h5>

					<ul class="nav nav-tabs" id="treinoTabs" role="tablist">
						<li class="nav-item" th:each="treino, stat : ${treinos}" role="presentation">
							<button class="nav-link" th:classappend="${stat.index == 0} ? 'active'"
								th:id="'tab-' + ${stat.index}"
								th:attr="data-bs-toggle='tab', data-bs-target='#treino-' + ${stat.index}" type="button"
								role="tab">
								Treino <span
									th:text="${#strings.toUpperCase(#strings.substring('ABCDEFGHIJKLMNOPQRSTUVWXYZ', stat.index, stat.index + 1))}"></span>
							</button>
						</li>
					</ul>

					<div class="tab-content mt-3" id="treinoContent">
						<div class="tab-pane fade" th:each="treino, stat : ${treinos}"
							th:classappend="${stat.index == 0} ? 'show active'" th:id="'treino-' + ${stat.index}"
							role="tabpanel" th:attr="aria-labelledby='tab-' + ${stat.index}">

							<h6 class="fw-bold mb-3" th:text="'Treino ' + ${treino.nome}"></h6>

							<div class="table-responsive">
								<table class="table table-striped table-bordered align-middle">
									<thead class="table-light">
										<tr>
											<th>Nome</th>
											<th>S√©rie</th>
											<th>Repeti√ß√µes</th>
											<th>Carga</th>
											<th>Observa√ß√£o</th>
										</tr>
									</thead>
									<tbody>
										<tr th:each="exercicio : ${treino.exercicios}">
											<td th:text="${exercicio.nome}"></td>
											<td th:text="${exercicio.serie}"></td>
											<td th:text="${exercicio.repeticoes}"></td>
											<td th:text="${exercicio.carga}"></td>
											<td th:text="${exercicio.observacao}"></td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>

			<!-- ‚úÖ Mensagem alternativa se ficha for nula -->
			<div th:if="${ficha == null}" class="alert alert-warning text-center mt-4">
				<i class="bi bi-info-circle-fill me-1"></i>
				Nenhuma ficha de treino registrada para este aluno.
			</div>

			<!-- Bot√£o de voltar -->
			<div class="mt-4">
				<a href="/" class="btn btn-outline-secondary btn-lg">
					<i class="bi bi-arrow-left-circle"></i> Voltar
				</a>
			</div>
		</div>

		<!-- Scripts -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
		<script>
			document.addEventListener('DOMContentLoaded', function () {
				const toggle = document.getElementById('toggleDarkMode');
				const body = document.body;

				if (localStorage.getItem('modoNoturno') === 'true') {
					body.classList.add('dark-mode');
				}

				if (toggle) {
					toggle.addEventListener('click', function () {
						body.classList.toggle('dark-mode');
						localStorage.setItem('modoNoturno', body.classList.contains('dark-mode'));
					});
				}
			});
		</script>
</body>

</html>